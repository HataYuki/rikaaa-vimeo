/**
 * @license
 * rikaaa-vimeo.js
 *
 * Generated : 2019-08-03
 * Version : 1.0.0
 * Author : rikaaa.org | Yuki Hata
 * Url : http://rikaaa.org
 *
 *
 * The MIT License (MIT)
 *
 * Copyright 2019 rikaaa.org | Yuki Hata
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy of this software and associated documentation files (the "Software"), to deal in the Software without restriction, including without limitation the rights to use, copy, modify, merge, publish, distribute, sublicense, and/or sell copies of the Software, and to permit persons to whom the Software is furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.
 */
!function(){"use strict";function t(e){return(t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(e)}function e(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function n(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function r(t,e,r){return e&&n(t.prototype,e),r&&n(t,r),t}function i(t){return(i=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function o(t,e){return(o=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function a(t,e,n){return(a=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(t){return!1}}()?Reflect.construct:function(t,e,n){var r=[null];r.push.apply(r,e);var i=new(Function.bind.apply(t,r));return n&&o(i,n.prototype),i}).apply(null,arguments)}function c(t){var e="function"==typeof Map?new Map:void 0;return(c=function(t){if(null===t||(n=t,-1===Function.toString.call(n).indexOf("[native code]")))return t;var n;if("function"!=typeof t)throw new TypeError("Super expression must either be null or a function");if(void 0!==e){if(e.has(t))return e.get(t);e.set(t,r)}function r(){return a(t,arguments,i(this).constructor)}return r.prototype=Object.create(t.prototype,{constructor:{value:r,enumerable:!1,writable:!0,configurable:!0}}),o(r,t)})(t)}function s(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function l(t){return function(t){if(Array.isArray(t)){for(var e=0,n=new Array(t.length);e<t.length;e++)n[e]=t[e];return n}}(t)||function(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}var u=function(t,e,n){return Math.max(e,Math.min(n,t))};[].keys||(Array.prototype.keys=function(){var t,e=[],n=0,r=this;for(t=r.length;t>0;)e[--t]=t;return e.next=function(){return n<r.length?{value:n++,done:!1}:{done:!0}},e});var d=function(){function n(t){e(this,n),this._parentNode,this._ctx,this._req,this._resolution=2,this._loadAnimation=!1;var r=document.createElement("canvas");this._parentNode=t,this._ctx=r.getContext("2d"),this._parentNode.appendChild(r),n.draw(this,r,this._parentNode,this._ctx)}return r(n,[{key:"stop",value:function(){cancelAnimationFrame(this._req)}},{key:"startLoadAnimation",value:function(){this._loadAnimation=!0}}],[{key:"draw",value:function(e,r,i,o){var a=i.getBoundingClientRect(),c=function(e,n,r,i,o,a){var c=Math.floor(e/r),s=Math.floor(n/i),d=l(Array(c).keys()).map(function(t){return l(Array(s).keys()).map(function(t){return-1})}),f=function(t,e){return Math.ceil(t/e*Math.random())},h=function(t,e){return Math.ceil(t/e*Math.random())},p=function(t,e,n,o,a,c){var s=0,u=o*a;if(0===o||0===a)return!1;l(Array(o).keys()).forEach(function(r){l(Array(a).keys()).forEach(function(i){try{-1===t[e+r][n+i]&&s++}catch(t){}})}),s===u&&(l(Array(o).keys()).forEach(function(r){l(Array(a).keys()).forEach(function(i){t[e+r][n+i]=c})}),t[e][n]={x:e*r,y:n*i,w:r*o,h:i*a})},y=0,v=o,m=a;do{for(var g=0;g<d.length;g+=1)for(var b=d[g],w=0;w<b.length;w+=1)y++,p(d,g,w,f(v,r),h(m,i),y);v=u(v/=5,1,o),m=u(m/=5,1,a)}while((1!==v||1!==m)&&l(d).reduce(function(t,e){return t.concat(e)},[]).includes(-1));return d.reduce(function(t,e){return t.concat(e)},[]).filter(function(e){return"object"===t(e)})}(2*a.width,2*a.height+10,2,10,11,70),s=function t(){e._req=requestAnimationFrame(t);var s=(a=i.getBoundingClientRect()).width,l=a.height;n.resolution(r,o,s,l,e._resolution),o.save(),o.fillStyle="#ffffff",c.forEach(function(t){e._loadAnimation&&(o.globalAlpha=Math.random()),o.fillRect(t.x,t.y,t.w-1,t.h-1)}),o.restore()};requestAnimationFrame(s)}},{key:"resolution",value:function(t,e,n,r,i){t.width=n*i,t.height=r*i,e.scale(i,i),t.style.width="".concat(n,"px"),t.style.height="".concat(r,"px")}}]),n}(),f="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};function h(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}function p(t,e){return t(e={exports:{}},e.exports),e.exports}var y=p(function(t,e){Object.defineProperty(e,"__esModule",{value:!0});var n=function(){function t(){}return t.is=function(e,n,r){void 0===r&&(r="0px");var i=t.computeParentNode(n,e);if(!1===i)return!1;for(var o=t.computeCheckTargetRectList(n,i,r),a=t.getBoundingClientRect(e),c=0;c!==o.length;){var s=o[c];if(s.width<=0||s.height<=0)return!1;if(s.bottom<=a.top||s.top>=a.bottom)return!1;c++}return!0},t.computeParentNode=function(e,n){for(var r=e||document.documentElement,i=[],o=document.documentElement,a=n;a!==o;)a=t.getParentNode(a),i.push(a);return!!i.includes(r)&&i.splice(0,i.indexOf(r)+1)},t.computeCheckTargetRectList=function(e,n,r){var i=e||document.documentElement;return n.map(function(e){return e!==i?t.getBoundingClientRect(e):t.getRootRect(e,r)})},t.getRootRect=function(e,n){var r=null,i=document.documentElement;return r=e!==i?t.getBoundingClientRect(e):{top:0,bottom:i.clientHeight,right:i.clientWidth,left:0,width:i.clientWidth,height:i.clientHeight},t.applyRootMargin(r,n)},t.applyRootMargin=function(e,n){var r=t.parseRootMargin(n),i=e.width,o=e.height,a="px"===r.top[1]?r.top[0]:o*r.top[0]/100,c="px"===r.bottom[1]?r.bottom[0]:o*r.bottom[0]/100,s="px"===r.right[1]?r.right[0]:i*r.right[0]/100,l="px"===r.left[1]?r.left[0]:i*r.left[0]/100,u={top:e.top-a,bottom:e.bottom+c,right:e.right+s,left:e.left-l,width:0,height:0};return u.width=u.right-u.left,u.height=u.bottom-u.top,u},t.parseRootMargin=function(t){var e=t.split(" "),n=function(t){return[parseFloat(t),t.match(/(px|%)/)[0]]},r={top:null,bottom:null,right:null,left:null};switch(e.length){case 1:r.top=n(e[0]),r.bottom=n(e[0]),r.right=n(e[0]),r.left=n(e[0]);break;case 2:r.top=n(e[0]),r.bottom=n(e[0]),r.right=n(e[1]),r.left=n(e[1]);break;case 4:r.top=n(e[0]),r.bottom=n(e[2]),r.right=n(e[1]),r.left=n(e[3])}return r},t.getParentNode=function(t){var e=t.parentNode;return e&&11==e.nodeType&&e.host?e.host:e&&e.assignedSlot?e.assignedSlot.parentNode:e},t.getBoundingClientRect=function(t){var e=null;try{return t.getBoundingClientRect()}catch(t){}if(null===e)return{top:0,bottom:0,left:0,right:0,width:0,height:0}},t}();e.default=n});h(y);var v=p(function(t,e){Object.defineProperty(e,"__esModule",{value:!0}),e.default=function(t){return"none"!==(t.currentStyle||getComputedStyle(t,"")).display}});h(v);var m=p(function(t,e){Object.defineProperty(e,"__esModule",{value:!0}),e.default=function(t){var e,n=!0;return function(){for(var r=[],i=0;i<arguments.length;i++)r[i]=arguments[i];return n?(e=t.apply(this,r),n=!1,e):(t=null,!1)}}});h(m);var g=p(function(t,e){Object.defineProperty(e,"__esModule",{value:!0}),e.default=function(t,e){var n=null;return function(){for(var r=[],i=0;i<arguments.length;i++)r[i]=arguments[i];clearTimeout(n),n=setTimeout(function(){return t.apply(this,r)},e)}}});h(g);var b=p(function(t,e){Object.defineProperty(e,"__esModule",{value:!0}),e.default=function(t,e){var n=null,r=null,i=m.default(t),o=g.default(t,e),a=g.default(function(){i=m.default(t),r=null,cancelAnimationFrame(n)},e);return function(){for(var c=this,s=[],l=0;l<arguments.length;l++)s[l]=arguments[l];return i.apply(this,s),n=requestAnimationFrame(function(i){if(null===r&&(r=i),i-r>=e)return r=null,cancelAnimationFrame(n),t.apply(c,s)}),a(),o.apply(this,s)}}});h(b);var w=p(function(t,e){Object.defineProperty(e,"__esModule",{value:!0}),e.default=function(t,e,n){void 0===n&&(n={observValKeyName:"watch"});var r=t,i=n.observValKeyName;return function(t){for(var n=[],o=null,a=0;a<arguments.length;a++)arguments[a]&&arguments[a].constructor==Object?(o=arguments[a][i],delete arguments[a][i],Object.keys(arguments[a]).length>0&&n.push(arguments[a])):n.push(arguments[a]);return r!==o&&(r=o,e.apply(this,n))}}});h(w),Array.prototype.includes||Object.defineProperty(Array.prototype,"includes",{value:function(t,e){if(null==this)throw new TypeError('"this" is null or not defined');var n=Object(this),r=n.length>>>0;if(0===r)return!1;var i,o,a=0|e,c=Math.max(a>=0?a:r-Math.abs(a),0);for(;c<r;){if((i=n[c])===(o=t)||"number"==typeof i&&"number"==typeof o&&isNaN(i)&&isNaN(o))return!0;c++}return!1}});var _=p(function(t,e){Object.defineProperty(e,"__esModule",{value:!0});var n=function(){function t(){this.instancesOfintersectionWatcher=[],this.targetsAll=[],this.scrollAreasOftargets=[],this.mutationObserverConfig={childList:!0,attributes:!0,characterData:!0,subtree:!0},this.watcher_binded=b.default(t.watcher.bind(null,this),t.THROTTLE_INTERVAL),this.mo=new MutationObserver(this.watcher_binded),this.firstCallback=g.default(m.default(function(e){e.forEach(function(e){var n=e.entries.map(function(e){if(t.isDisplay(e.target))return Object.freeze({target:e.target,isIntersecting:e.isIntersecting})}).filter(function(t){return void 0!==t});0!==n.length&&e.callback(n)})}),t.THROTTLE_INTERVAL)}return t.prototype.init=function(t){this.instancesOfintersectionWatcher.push(t)},t.prototype.observe=function(){this.targetsAll=t.updateTargetsAll(this),this.scrollAreasOftargets=t.updateScrollAreasOftargets(this.targetsAll),0!==this.targetsAll.length&&t.onWather(this),this.entriesContaner=t.calculateEntriesContaner(this.instancesOfintersectionWatcher),this.firstCallback(this.entriesContaner)},t.prototype.unobserve=function(){this.targetsAll=t.updateTargetsAll(this),this.entriesContaner=t.calculateEntriesContaner(this.instancesOfintersectionWatcher)},t.prototype.disconnect=function(){this.targetsAll=t.updateTargetsAll(this),this.entriesContaner=t.calculateEntriesContaner(this.instancesOfintersectionWatcher),0===this.targetsAll.length&&(t.offWather(this),this.scrollAreasOftargets=[])},t.watcher=function(e){e.entriesContaner.forEach(function(e){var n=e.entries.map(function(n){var r=e.option,i=t.isDisplay(n.target),o=t.isIntersecting(n.target,r.root,r.rootMargin),a=n.valueObserver({watch:o});if(a&&(n.isIntersecting=o),i&&a)return Object.freeze({target:n.target,isIntersecting:n.isIntersecting})}).filter(function(t){return void 0!==t});0!==n.length&&e.callback(n)})},t.calculateEntriesContaner=function(e){return e.map(function(e){var n=e.option,r=e.targets.map(function(e){var r=t.isIntersecting(e,n.root,n.rootMargin);return{target:e,isIntersecting:r,valueObserver:w.default(r,function(){return!0})}});return e.entries=r,e})},t.updateTargetsAll=function(t){return t.instancesOfintersectionWatcher.map(function(t){return t.targets}).reduce(function(t,e){return t.concat(e)},[])},t.updateScrollAreasOftargets=function(t){return t.map(function(t){return function(t){for(var e=[],n=document.documentElement,r=t;r!==n;)r=y.default.getParentNode(r),e.push(r);return e}(t).filter(function(t){var e=getComputedStyle(t,"");if("scroll"===e.overflow||"auto"===e.overflow||"scroll"===e.overflowY||"auto"===e.overflowY)return!0})}).reduce(function(t,e){return t.concat(e)},[])},t.onWather=function(t){var e={passive:!0};window.addEventListener("resize",t.watcher_binded,!1),window.addEventListener("scroll",t.watcher_binded,e),document.documentElement.addEventListener("scroll",t.watcher_binded,e),document.body.addEventListener("scroll",t.watcher_binded,e),t.mo.observe(document.querySelector("html"),t.mutationObserverConfig),t.scrollAreasOftargets.forEach(function(n){n.addEventListener("scroll",t.watcher_binded,e)})},t.offWather=function(t){window.removeEventListener("resize",t.watcher_binded),window.removeEventListener("scroll",t.watcher_binded),document.documentElement.removeEventListener("scroll",t.watcher_binded),document.body.removeEventListener("scroll",t.watcher_binded),t.mo.disconnect(),t.scrollAreasOftargets.forEach(function(e){e.removeEventListener("scroll",t.watcher_binded)})},t.isIntersecting=function(t,e,n){return y.default.is(t,e,n)},t.isDisplay=function(t){return v.default(t)},Object.defineProperty(t,"THROTTLE_INTERVAL",{get:function(){return 33},enumerable:!0,configurable:!0}),t}();e.default=n});h(_);var O=h(p(function(t,e){var n=f&&f.__assign||function(){return(n=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var i in e=arguments[n])Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t}).apply(this,arguments)};Object.defineProperty(e,"__esModule",{value:!0});var r={rootMargin:"0px",root:null},i=new _.default,o=function(){function t(t,e){void 0===e&&(e={}),this.callback=t,this.targets=[],this.entries=[],this.option=n({},r,e),i.init(this)}return t.prototype.observe=function(t){this.targets.includes(t)||this.targets.push(t),i.observe()},t.prototype.unobserve=function(t){this.targets=this.targets.filter(function(e){return e!==t}),i.unobserve()},t.prototype.disconnect=function(){this.targets=[],i.disconnect()},t.isIntersecting=function(t,e,n){return _.default.isIntersecting(t,e,n)},t.isDisplay=function(t){return _.default.isDisplay(t)},Object.defineProperty(t,"THROTTLE_INTERVAL",{get:function(){return _.default.THROTTLE_INTERVAL},enumerable:!0,configurable:!0}),Object.defineProperty(t,"CONTROLLER",{get:function(){return i},enumerable:!0,configurable:!0}),t}();e.default=o}));String.prototype.padStart||(String.prototype.padStart=function(t,e){return t>>=0,e=String(void 0!==e?e:" "),this.length>=t?String(this):((t-=this.length)>e.length&&(e+=e.repeat(t/e.length)),e.slice(0,t)+String(this))});var E="<style>".concat(":host {  position: relative;  display: block;  width: 100%;  font-size: 100%;  line-height: 1.4; }  :host img, :host iframe {    vertical-align: bottom; }  :host iframe {    border: none; }  :host button {    background-color: transparent;    border: none;    cursor: pointer;    outline: none;    padding: 0;    -webkit-appearance: none;       -moz-appearance: none;            appearance: none; }  :host .container-wrap {    position: relative;    width: 100%;    cursor: pointer; }    :host .container-wrap .placeholder {      pointer-events: none; }    :host .container-wrap .container {      position: absolute;      top: 0;      left: 0;      bottom: 0;      right: 0; }      :host .container-wrap .container img, :host .container-wrap .container iframe, :host .container-wrap .container .loading-icon {        position: absolute;        width: 100%;        height: 100%;        top: 0;        left: 0; }      :host .container-wrap .container img {        z-index: 2; }      :host .container-wrap .container iframe {        z-index: 1; }      :host .container-wrap .container .loading-icon {        width: 5%;        height: auto;        z-index: 3;        right: 0;        left: auto;        visibility: hidden;        max-width: 40px;        min-width: 30px;        top: 10px;        right: 10px; }        :host .container-wrap .container .loading-icon:hover {          opacity: 0.5; }        :host .container-wrap .container .loading-icon .placeholder {          padding-top: 100%; }      :host .container-wrap .container .description {        display: none;        position: absolute;        right: 0;        bottom: 0;        width: auto;        color: white;        z-index: 3;        margin: 0;        text-align: right;        background: rgba(0, 0, 0, 0.4);        padding: 1px 10px 0 10px;        border: 1px solid white;        border-radius: 5px;        bottom: 5px;        right: 5px;        font-size: 0.875rem; }","</style>"),k="\n    ".concat(E,'\n    <div class="container-wrap">\n    <div class="placeholder"v></div>\n    <div class="container main-container">\n        <p class="description"></p>\n        <div class="loading-icon">\n            <div class="container-wrap">\n                <div class="placeholder"></div>\n                <div class="container"></div>\n            </div>\n        </div>\n    </div>\n    </div>\n'),S=document.createElement("template");S.id="rikaaavimeo",S.innerHTML=k,window.ShadyCSS&&ShadyCSS.prepareTemplate(S,"rikaaa-vimeo");var A=function(t){function n(){var t,r,o;return e(this,n),r=this,t=!(o=i(n).call(this))||"object"!=typeof o&&"function"!=typeof o?s(r):o,window.ShadyCSS&&ShadyCSS.styleElement(s(t)),t.attachShadow({mode:"open"}),t.shadowRoot.appendChild(S.content.cloneNode(!0)),window.IntersectionObserver||window.WcRikaaaIntersectionObserver||Object.defineProperty(window,"WcRikaaaIntersectionObserver",{value:O}),t._vimeoId,t._size,t._loadtimeing="200px 0px 200px 0px",t._query="?autoplay=1&title=0&byline=0&portrait=0",t._dizolveDuration=100,t._loadVimeo,t._thumnailClickFun,t._intersectionobserver=window.IntersectionObserver||window.WcRikaaaIntersectionObserver,t}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&o(t,e)}(n,c(HTMLElement)),r(n,[{key:"connectedCallback",value:function(){this._size&&n.setAreaSize(this,this._size),this._vimeoId&&!this._loadVimeo&&n.prepareLoad(this,{rootMargin:this._loadtimeing}),this.dispatchEvent(new CustomEvent("load"))}},{key:"attributeChangedCallback",value:function(t,e,n){"vimeoid"===t&&(this._vimeoId=n),"size"===t&&(this._size=n.split("x")),"loadtiming"===t&&(this._loadtimeing=n),"query"===t&&(this._query=n)}},{key:"disconnectedCallback",value:function(){this._loadVimeo.unobserve(this),this._loadVimeo.disconnect(),this._thumnailClickFun&&this.shadowRoot.querySelector(".container-wrap").removeEventListener("click",this._thumnailClickFun),this._whenPlay&&window.removeEventListener("message",this._whenPlay)}},{key:"init",value:function(t){var e=this;this._loadVimeo.unobserve(this),this._loadVimeo.disconnect();var r=this.shadowRoot.querySelector(".description");n.getVimeoJson(t).then(function(i){var o,a=i[0],c=n.parserThumbnailId(a.thumbnail_large),s=n.parserThumnailUrl(c,a.width),l=n.parserVimeoIframeUrl(t,e._query),u=n.parseDuration(a.duration);r.innerHTML=u,r.style.display="block",(o=s,new Promise(function(t,e){var n=new Image;n.addEventListener("load",function(e){return t(n)}),n.src=o})).then(function(t){n.setAreaSize(e,[a.width,a.height]),n.setVimeoThumbnail(e,t),e._thumnailClickFun=n.setVimeoIframe.bind(null,e,l),e._loadingIcon||(e._loadingIcon=new d(e.shadowRoot.querySelector(".loading-icon .container"))),e.shadowRoot.querySelector(".container-wrap").addEventListener("click",e._thumnailClickFun,!1),e.dispatchEvent(new CustomEvent("loadThumnail",{detail:{data:a}}))})})}},{key:"setRoot",value:function(t){n.prepareLoad(this,{rootMargin:this._loadtimeing,root:t})}}],[{key:"setAreaSize",value:function(t,e){var n,r,i=t.shadowRoot.querySelector(".placeholder"),o=(n=e[0],r=e[1],[n,r].reduce(function(t,e,n,r){var i={},o=function t(e,n){return n?t(n,e%n):e};return 0===n&&(i.w=e/o(r[1],r[0])),1===n&&(i.h=e/o(r[1],r[0])),Object.assign(t,i)},{})),a=o.h/o.w*100;i.style.paddingTop="".concat(a,"%")}},{key:"setVimeoThumbnail",value:function(t,e){var n=t.shadowRoot.querySelector(".container");e.style.width="100%",e.classList.add("thumbnail-img"),n.appendChild(e)}},{key:"setVimeoIframe",value:function(t,e){var r=t.shadowRoot.querySelector(".container"),i=t._loadingIcon,o=t._dizolveDuration,a=t.shadowRoot.querySelector(".thumbnail-img"),c=t.shadowRoot.querySelector(".loading-icon"),s=t.shadowRoot.querySelector(".description");c.style.visibility="visible",i.startLoadAnimation(),t.shadowRoot.querySelector(".container-wrap").removeEventListener("click",t._thumnailClickFun),function(t,e){return new Promise(function(n,r){var i=document.createElement("iframe");i.setAttribute("webkitallowfullscreen",!0),i.setAttribute("mozallowfullscreen",!0),i.setAttribute("allowfullscreen",!0),i.setAttribute("allow","autoplay"),i.src=t,e.appendChild(i),i.style.visibility="hidden",i.onload=function(t){return n(i)}})}(e,r).then(function(r){var l=n.isAutoplay(e),u="all ".concat(o,"ms ease-in");if(r.style.transition=u,a.style.transition=u,c.style.transition=u,s.style.transition=u,l){var d=r.contentWindow;r.style.visibility="",r.style.opacity="0",d.postMessage(JSON.stringify({method:"pause"}),e),d.postMessage(JSON.stringify({method:"play"}),e),t._whenPlay=function(n){"play"===JSON.parse(n.data).method&&(i.stop(),r.style.opacity="1",a.style.opacity="0",a.style.visibility="hidden",c.style.opacity="0",c.style.visibility="hidden",s.style.opacity="0",s.style.visibility="hidden",d.postMessage(JSON.stringify({method:"play"}),e),d.postMessage(JSON.stringify({method:"play"}),e),window.removeEventListener("message",t._whenPlay),t.dispatchEvent(new CustomEvent("loadIframe")))},window.addEventListener("message",t._whenPlay)}else i.stop(),r.style.visibility="",r.style.opacity="1",a.style.opacity="0",a.style.visibility="hidden",c.style.opacity="0",c.style.visibility="hidden",s.style.opacity="0",s.style.visibility="hidden",t.dispatchEvent(new CustomEvent("loadIframe"))})}},{key:"parseDuration",value:function(t){var e=function(t){return t.toString().padStart(2,"0")},n=t,r=parseInt(n/3600);n%=3600;var i=parseInt(n/60);return n%=60,"".concat(e(r),":").concat(e(i),":").concat(e(n))}},{key:"prepareLoad",value:function(t,e){t._loadVimeo&&(t._loadVimeo.unobserve(t),t._loadVimeo.disconnect());var n,r,i,o=e||{},a=(n=t.init.bind(t),i=!0,function(){return i?(r=n.apply(this,arguments),i=!1,r):(n=null,!1)});t._loadVimeo=new t._intersectionobserver(function(e){e[0].isIntersecting&&a(t._vimeoId)},o),t._loadVimeo.observe(t)}},{key:"getVimeoJson",value:function(t){return(e="https://vimeo.com/api/v2/video/".concat(t,".json"),n=new XMLHttpRequest,n.open("GET",e,!0),n.send(),new Promise(function(t,e){n.onload=function(){t(n.response)},n.onerror=function(){e(n.statusText)}})).then(function(t){return JSON.parse(t)});var e,n}},{key:"parserVimeoIframeUrl",value:function(t,e){return e?"https://player.vimeo.com/video/".concat(t).concat(e):"https://player.vimeo.com/video/".concat(t)}},{key:"parserThumnailUrl",value:function(t,e){return"https://i.vimeocdn.com/video/".concat(t,"_").concat(e,".jpg")}},{key:"isAutoplay",value:function(t){return 1===Number(t.match(/autoplay=\d/)[0].replace("autoplay=",""))}},{key:"parserThumbnailId",value:function(t){return Number(t.match(/\/\d+_/)[0].replace("/","").replace("_",""))}},{key:"observedAttributes",get:function(){return["vimeoid","loadtiming","size","query"]}}]),n}();customElements.define("rikaaa-vimeo",A)}();